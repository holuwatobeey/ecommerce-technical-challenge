{"version":3,"sources":["../../src/middlewares/isAdmin.js"],"names":["req","res","next","token","header","status","json","message","decoded","jwt","verify","process","env","JWT_SECRET","user","role","exception"],"mappings":";;;;;;AAAA;;;;;;kBAEe,UAACA,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC/B,QAAMC,QAAQH,IAAII,MAAJ,CAAW,cAAX,CAAd;AACA,QAAI,CAACD,KAAL,EAAY;AACR,eAAOF,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBC,qBAAS;AADe,SAArB,CAAP;AAGH;;AAED,QAAI;AACA,YAAMC,UAAUC,uBAAIC,MAAJ,CAAWP,KAAX,EAAkBQ,QAAQC,GAAR,CAAYC,UAA9B,CAAhB;AACAb,YAAIc,IAAJ,GAAWN,OAAX;AACA,YAAGA,QAAQO,IAAR,IAAgB,CAAnB,EAAqB;AACjBd,gBAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBC,yBAAS;AADQ,aAArB;AAGH;AACDL;AACH,KATD,CASE,OAAOc,SAAP,EAAkB;AAChBf,YAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBC,qBAAS;AADQ,SAArB;AAGH;AACJ,C","file":"isAdmin.js","sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nexport default (req, res, next) => {\r\n    const token = req.header('x-auth-token');\r\n    if (!token) {\r\n        return res.status(401).json({\r\n            message: 'Access denied, no token provided'\r\n        });\r\n    }\r\n\r\n    try {\r\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n        req.user = decoded;\r\n        if(decoded.role != 0){\r\n            res.status(403).json({\r\n                message: 'Unauthorized'\r\n            });\r\n        }\r\n        next();\r\n    } catch (exception) {\r\n        res.status(400).json({\r\n            message: 'Invalid token'\r\n        });\r\n    }\r\n};"]}